# P4 User Story Mapping

Связанные документы:
- `../p1-discovery/P1_DISCOVERY.md`
- `../p2-one-pager-prd/P2_ONE_PAGER_PRD.md`
- `../p3-scope/P3_SCOPE_PLAN.md`

## 1. Цель карты
Разложить путь пользователя на этапы и зафиксировать, какие шаги входят в MVP (Release 1), а какие переносятся на следующие итерации.

## 2. Персона и контекст
Персона: Senior Go Engineer / SRE в observability-команде.
Контекст: расследование инцидента, review сложного PR, оценка impact изменений.

## 3. Backbone (путь пользователя)
1. Определить вопрос исследования.
2. Найти входную сущность (функция/переменная/пакет).
3. Построить фокусный подграф.
4. Проверить исходный код и связи.
5. Углубиться или сменить режим анализа.
6. Зафиксировать вывод и перейти к следующей гипотезе.

## 4. Story Map по релизным срезам
| Backbone шаг | Release 1 (MVP / Must) | Release 2 (Should) | Release 3 (Could) |
|---|---|---|---|
| 1. Определить вопрос | Выбор режима: Calls / Dataflow / Packages | Быстрые стартовые шаблоны сценариев | Встроенный guided tour |
| 2. Найти вход | Базовый старт из известной сущности в текущем режиме | Поиск символов по имени | Горячие клавиши поиска |
| 3. Построить подграф | Серверные лимиты, фокус 10-100 узлов, BFS/dataflow/package view | Тонкая настройка лимитов в UI | Сохранение пользовательских пресетов |
| 4. Проверить код | Клик по узлу -> source panel + детали | Улучшенный context trail | Пины/закладки на строки кода |
| 5. Углубиться | Переход к соседним узлам и перестроение графа | История навигации между режимами | Автопредложение следующего шага анализа |
| 6. Зафиксировать вывод | Стабильный demo flow и повторяемый результат | Быстрый экспорт SQL из Workbench | Экспорт отчета по сессии |

## 5. MVP Slice (горизонтальный срез для демо)
1. Пользователь открывает режим `Calls` и строит call-neighborhood.
2. Выбирает узел и переходит в исходный код.
3. Переключается в `Dataflow` и строит forward/backward срез.
4. Открывает `Packages` для архитектурного контекста.
5. Повторяет сценарий без ручной настройки окружения через `docker compose up`.

## 6. Проверка полноты карты
1. Каждый backbone-шаг покрыт хотя бы одной историей в MVP.
2. Каждая MVP-история привязана к измеримому acceptance criterion.
3. Любой шаг, не влияющий на time-to-insight, вынесен в `Should/Could`.
